<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pilot-SignBridge</title>
  <link rel="stylesheet" href="style.css" />
  <link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
</head>
<body>
  <!-- Language Switch -->
  <div class="lang-switch">
    <button class="lang-btn" onclick="setLang('en')">EN</button>
    <button class="lang-btn" onclick="setLang('ru')">RU</button>
  </div>

  <!-- Hero -->
  <header>
    <h1>Pilot-SignBridge</h1>
    <p data-i18n="subtitle"></p>
  </header>

  <div class="container">
    <!-- Buttons -->
    <main>
      <a href="https://github.com/pilotextensions/Pilot-SignBridge/releases/download/v1.0.0/PilotSignBridge.msi" class="btn btn-blue" data-i18n="btnWin"></a>
      <a href="https://chrome.google.com/webstore/detail/your-extension-id" class="btn btn-green" data-i18n="btnChrome"></a>
    </main>

    <!-- About -->
    <section>
      <h2 data-i18n="aboutTitle"></h2>
      <p data-i18n="aboutIntro"></p>
      <p data-i18n="aboutListTitle"></p>
      <ul id="about-list"></ul>
      <p data-i18n="aboutSecurity"></p>
      <p data-i18n="aboutPro"></p>
    </section>

    <!-- Instructions -->
    <section>
      <h2 data-i18n="installTitle"></h2>
      <ol>
        <li data-i18n="steps.0"></li>
        <li data-i18n="steps.1"></li>
        <li data-i18n="steps.2"></li>
        <li data-i18n="steps.3"></li>
      </ol>
    </section>

    <!-- Code Example -->
    <section>
      <h2 data-i18n="exampleTitle"></h2>
      <pre><code class="language-js">
  // Example: call Pilot-SignBridge API from your site
  
  // Sign file with selected certificate
  function sign(certThumbprint: string, buffer: ArrayBuffer): Promise&lt;string&gt; {
    if (!window.pilotSignBridge) {
      return Promise.reject("Extension not found");
    }
    return window.pilotSignBridge.signFile(certThumbprint, buffer);
  }

  // Verify signature
  function verify(signBase64: string, file: ArrayBuffer): Promise&lt;VerifyStreamFinishResponse&gt; {
    if (!window.pilotSignBridge) {
      return Promise.reject("Extension not found");
    }

    return window.pilotSignBridge.verifyFile(signBase64, file);
  }

  // Get list of available certificates
  function async getCertificates(): Promise&lt;ICertificate[]&gt; {
    if (!window.pilotSignBridge) {
      return Promise.reject("Extension not found");
    }

    const certs = await window.pilotSignBridge.getCerts() as ISignBridgeCertificate[];
    return certs.map(cert => {
      return {
        issuer: cert.Issuer,
        publicKeyOid: cert.PublicKeyOid,
        subject: cert.Subject,
        thumbprint: cert.Thumbprint,
        validFromDate: DateTime.fromISO(cert.ValidFromDate).toUTC().toFormat("yyyy-MM-dd'T'HH:mm:ss"),
        validToDate: DateTime.fromISO(cert.ValidToDate).toUTC().toFormat("yyyy-MM-dd'T'HH:mm:ss")
      };
    });
  }

  // Get supported algorithms
  getSupportedAlgorithms(): Promise&lt;string[]&gt; {
    if (!window.pilotSignBridge) {
      return Promise.reject("Extension not found");
    }
    return window.pilotSignBridge.getSupportedAlgorithms();
  }


  // How to use
  const arrayBuffer = new TextEncoder().encode("Hello, world!").buffer;
  try {
    const signedBase64 = await sign("abc123...", arrayBuffer)
    console.log("Signed data:", signedBase64);
  } catch (err) {
    console.error("Signing error:", err);
  }
      </code></pre>
    </section>
  </div>
  <!-- Footer -->
  <footer>
    <a href="https://drive.google.com/file/d/1_1WA2GjKbwGrXQ8ab6vFY0ETMxmqOCIq/view" target="_blank" data-i18n="privacy"></a>
    <a href="https://github.com/pilotextensions/pilot-signbridge">GitHub</a>
  </footer>

  <!-- Prism + i18next -->
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-javascript.min.js"></script>
  <script src="https://unpkg.com/i18next@22.4.15/dist/umd/i18next.min.js"></script>
  <script src="https://unpkg.com/i18next-http-backend@2.6.1/i18nextHttpBackend.min.js"></script>
  <script src="https://unpkg.com/i18next-browser-languagedetector@7.1.0/dist/umd/i18nextBrowserLanguageDetector.min.js"></script>
  <script src="https://unpkg.com/jquery@3.7.1/dist/jquery.min.js"></script>
  <script src="https://unpkg.com/jquery-i18next@1.2.1/dist/umd/jquery-i18next.min.js"></script>

  <script src="script.js"></script>
</body>
</html>
